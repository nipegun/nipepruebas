# phaipentester

Framework de pentesting automatizado con inteligencia artificial

## Descripción

phaipentester es un framework modular de pentesting que utiliza modelos de lenguaje (LLMs) para automatizar y asistir en pruebas de penetración. Implementa el patrón Model Context Protocol (MCP) para comunicación entre el orquestador y las herramientas de pentesting.

## Estructura del Proyecto

```
PenTesterIA/
├── menu.py                   # Menú principal - Punto de entrada
├── README.md                 # Este archivo
│
├── web/                        # ✓ Framework Web Pentesting (IMPLEMENTADO)
│   ├── orchestrator.py         # Orquestador principal
│   ├── mcp-server.py           # Servidor MCP con herramientas web
│   ├── system-prompt.txt       # Metodología OWASP y prompts
│   ├── tools.txt               # Definición de herramientas MCP
│   ├── requirements-debian.txt # Dependencias del sistema
│   └── requirements-python.txt # Dependencias de python
│
├── network/                  # ✗ Framework Network Pentesting (EN DESARROLLO)
│   └── README.md             # Guía de implementación
│
└── wireless/                 # ✗ Framework Wireless Pentesting (EN DESARROLLO)
    └── README.md             # Guía de implementación
```

## Uso

### Inicio rápido

```bash
cd $HOME/HackingTools/phaipentester
python3 menu.py
```

### Menú Principal

El menú te permite elegir el tipo de pentesting:

```
[1] Web Application Pentesting
    └─ Análisis de aplicaciones web, APIs, vulnerabilidades OWASP

[2] Network Pentesting
    └─ Escaneo de redes, análisis de puertos, vulnerabilidades de red

[3] Wireless Pentesting
    └─ WiFi, Bluetooth, redes inalámbricas

[0] Salir
```

## Frameworks Disponibles

### ✓ Web Application Pentesting (IMPLEMENTADO)

**Estado**: Completamente funcional

**Características**:
- Verificación automática de dependencias
- Workspace organizado por objetivo
- Herramientas MCP: HTTP GET/POST, dirscan, SQLi scan, XSS scan
- Generación automática de exploits/PoCs
- Informes técnicos (Markdown) y ejecutivos (HTML)
- Clasificación OWASP Top 10 y CWE
- Integración con llama.cpp para LLM local

**Uso directo**:
```bash
cd web/
python3 orchestrator.py
```

**Herramientas incluidas**:
- `http.get` / `http.post` - Peticiones HTTP
- `dirscan` - Escaneo de directorios (gobuster/dirsearch)
- `sqli.scan` - Detección de SQL Injection
- `xss.scan` - Detección de XSS
- `report.write` - Generación de reportes
- `exploit.write_poc` / `exploit.run` - Creación y ejecución de PoCs

### ✗ Network Pentesting (EN DESARROLLO)

Ver `network/README.md` para detalles de implementación.

### ✗ Wireless Pentesting (EN DESARROLLO)

Ver `wireless/README.md` para detalles de implementación.

## Requisitos del Sistema

### Software Base

- Python 3.8+
- llama.cpp server (puerto 8080)
- Debian/Ubuntu Linux

### Dependencias Python

```bash
pip3 install websockets requests asyncio
```

### Herramientas de Pentesting

Cada framework tiene su propio `requirements.txt` con las herramientas necesarias. El sistema verifica automáticamente las dependencias al iniciar.

## Arquitectura

```
┌─────────────────┐
│   menu.py       │  Selector de framework
└────────┬────────┘
         │
    ┌────┴─────┬──────────┬────────────┐
    │          │          │            │
┌───▼────┐ ┌──▼─────┐ ┌──▼────────┐    │
│  Web   │ │Network │ │ Wireless  │    │
└───┬────┘ └────────┘ └───────────┘    │
    │                                  │
┌───▼──────────────┐                   │
│ orchestrator.py  │◄──────────────────┘
└────┬─────────────┘
     │
     ├──► llama.cpp (LLM local, puerto 8080)
     │
     └──► MCP Server (WebSocket, puerto 9001)
          │
          ├──► Herramientas de pentesting
          ├──► Generación de evidencias
          ├──► Ejecución de exploits
          └──► Generación de informes
```

## Workspace

Cada objetivo crea un workspace organizado:

```
/home/nipegun/pt-web-workspace/{objetivo}/
├── logs/         # Logs de tool calls con timestamps
├── evidence/     # Requests/responses capturados
├── exploits/     # PoCs generados y ejecutables
└── report/       # Informes finales (MD/HTML)
```

## Metodología

El framework sigue metodologías estándar de la industria:

- **Web**: OWASP Top 10, OWASP Testing Guide
- **Network**: PTES, NIST SP 800-115
- **Wireless**: NIST SP 800-153, OWASP IoT Top 10

Todas las vulnerabilidades se clasifican con:
- OWASP category
- CWE mapping
- Severidad (Baja/Media/Alta/Crítica)
- Steps to reproduce
- PoC funcional
- Recomendaciones técnicas

## Desarrollo

Para implementar un nuevo framework:

1. Copiar estructura de `web/` a la nueva carpeta
2. Adaptar `orchestrator.py` para el tipo de pentesting
3. Implementar herramientas MCP específicas
4. Crear `system-prompt.txt` con metodología apropiada
5. Definir herramientas en `tools.txt`
6. Listar dependencias en `requirements.txt`

## Licencia

Uso educativo y autorizado únicamente. No usar para actividades maliciosas.

## Autor

NiPeGun - Framework PenTesterIA
